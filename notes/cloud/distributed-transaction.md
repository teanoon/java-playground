- [1. Two Phase Commit ？](#1-two-phase-commit-)
  - [1.1. 步骤](#11-步骤)
  - [1.2. 方案优劣](#12-方案优劣)
  - [1.3. 实现](#13-实现)
- [2. Three Phase Commit ？](#2-three-phase-commit-)
  - [2.1. 步骤](#21-步骤)
  - [2.2. 方案优劣](#22-方案优劣)
- [3. 消息队列模式](#3-消息队列模式)

# 1. Two Phase Commit ？
## 1.1. 步骤
1. 准备阶段
   1. 协调者发送事务内容，各个参与者执行事务但不提交，记录 undo 和 redo 日志并反馈执行结果
2. 提交阶段
   * 协调者收到全部参与者的成功结果后，发送 commit 指令，各个参与者正式提交事务。
   * 协调者收到参与者的失败结果或者超时后，则发送 rollback 指令，各个参与者进行 rollback。

## 1.2. 方案优劣
优点：
* 实现简单

缺点：
* 性能问题。协调者等待期间阻塞请求，参与者等待期间阻塞请求
* 可靠性问题。协调者单点出错则阻塞参与者
* 数据一致性问题。协调者发起提交指令后，若部分参与者未能接收到指令，则会出现数据不一致现象

## 1.3. 实现
1. AT
2. XA(DTP)
3. Try-Confirm-Cancel

# 2. Three Phase Commit ？
## 2.1. 步骤
1. 准备阶段
   1. 协调者发送事务内容，各个参与者返回是否可以执行事务
2. 预提交阶段
   * 协调者收到全部确认后，发送事务内容，各个参与者执行事务但不提交，记录 undo 和 redo 日志并反馈执行结果
   * 协调者收到否定反馈或超时后，发送 abort 指令，各个参与者则中断事务
3. 提交阶段
   * 协调者收到全部参与者的成功结果后，发送 commit 指令，各个参与者正式提交事务。
   * 协调者收到参与者的失败结果或者超时后，则发送 rollback 指令，各个参与者进行 rollback。

## 2.2. 方案优劣
类似于 2PC ，减少了阻塞的可能性，但未真正解决性能和数据一致性问题。

# 3. 消息队列模式
